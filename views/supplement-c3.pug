extends layout.pug
block content
    h1 C.3 | Rationale for Parallel Velma and Reach Segmentation
    div.info.blue-light-1
        p Overview (Tutorial C.3 - Rationale for Parallel Velma)
        p This tutorial provides the rationale for setting up and running VELMA in parallel mode, whereby a large watershed is broken up into smaller subwatersheds that can be run in parallel more efficiently. This requires segmentation of the overall stream network.

    p VELMA links a hydrological model with a biogeochemical model. The modeling unit is a square grid cell with up to eight adjacent grid cells. Processing of each grid cell includes computing transfers of water and chemicals from adjacent uphill cells, and to adjacent downhill cells. Transfers into or out of a cell can happen from any adjacent uphill or downhill, so a cell may have multiple flow directions. Having multiple flow directions is more realistic in general but is problematic in certain cases. VELMA starts with a set of cells that are delineated from an outlet point and include all cells whose primary flow direction sends water to the given outlet. Cells that are on the edge of this set could have flow into cells that are not included in the set, and cells outside the set may have flow into the set. This is a problem for a couple reasons. Cells on the edge of the delineated watershed behave differently from cells within the watershed in that a pair of cells with the downhill cell in the watershed and the uphill cell not in the watershed does not contribute water from the uphill cell to the downhill cell, whereas a pair of cells with the same configuration inside the watershed would have water contributed from the uphill to the downhill cell.
    p A desirable property of VELMA watershed processing is to get identical results for a cell whether the cell is being processed as an edge cell or as an interior cell. This property would then extend to say that a sub-watershed processed independently should get identical results when processed as part of a larger watershed.
    p In VELMA we get this property by selecting a set of sub-outlets that divide the watershed into a set of catchments and then require that water transfer occur only when adjacent cells are in the same catchment or if the upper cell is one of the designated outlets. This produces several desirable behaviors. First, given a set of outlets, processing a cell or catchment independently will produce the same results if the cell or catchment is processed as part of a larger watershed. In addition, communication between catchments is only through the set of outlets, further streamlining processing. This allows catchments to be processed by VELMA independently, either serially or in parallel, allowing for faster processing and allowing for the processing of much larger watersheds. It produces a less desirable behavior though. The overall results depend on the assignment of outlets. Adding an outlet changes the water flow from cells that are now considered to be outside the catchment delineated by the new outlet. Differences are small but significant.
    p Another way to get identical behavior would be to include in processing all cells uphill from a given outlet. This ensures that for each cell, whether interior or edge, processing will be identical. However, in many cases, the additional number of cells can be quite large. For processing in parallel, the communication between catchments now many include all border cells, not just the outlets. The redundancy of processing plus the cost of communication between catchments makes parallel processing effectively worthless. Even in the purely serial case the amount of extra processing is significant.
    p Using square grid cells will always be a compromise. For channel cells we don't account for how much of the cell is the stream and how much is riparian boundary. For ridge cells we don't account for where the high point is within the cell. Adding an additional convention to ridge cells, that all water and chemicals flow into only one of the catchments divided by the cell, seems like a small cost to pay for the benefit of being about to subdivide a watershed and process catchments individually.