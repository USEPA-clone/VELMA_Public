<!DOCTYPE html><html><head><meta name="viewport" content="width=device-width"><meta name="charset" content="utf-8"><link rel="stylesheet" type="text/css" href="/style.css"><title> </title></head><body class="bg-primary"><div class="header blue-base"><nav class="navbar blue-base navbar-expand"><a class="navbar-brand" href="/index.html">VELMA 2.2 HOME</a><ul class="navbar-nav no-bullets"><li class="nav-item"><a class="nav-link" href="/intro.html"><span>I. Intro</span></a></li><li class="nav-item"><a class="nav-link" href="/changes.html"><span>II. Changes from 1.0</span></a></li><li class="nav-item"><a class="nav-link" href="/about.html"><span>III. About</span></a></li><li class="nav-item"><a class="nav-link" href="/input_files.html"><span>IV. Input Files </span></a></li><li class="nav-item"><a class="nav-link" href="/new_sim_config.html"><span>V. Sim Config</span></a></li><li class="nav-item"><a class="nav-link" href="/parameter_config.html"><span>VI. Parameter Config</span></a></li><li class="nav-item dropdown">Appendicies<ul class="nav-dropdown blue-light"><li class="nav-item"><a class="nav-link" href="/appendix_1.html"><span>Appendix 1</span></a></li><li class="nav-item"><a class="nav-link" href="/appendix_2.html"><span>Appendix 2</span></a></li><li class="nav-item"><a class="nav-link" href="/appendix_3.html"><span>Appendix 3</span></a></li><li class="nav-item"><a class="nav-link" href="/appendix_4.html"><span>Appendix 4</span></a></li><li class="nav-item"><a class="nav-link" href="/appendix_5.html"><span>Appendix 5</span></a></li><li class="nav-item"><a class="nav-link" href="/appendix_6.html"><span>Appendix 6</span></a></li><li class="nav-item"><a class="nav-link" href="/appendix_7.html"><span>Appendix 7</span></a></li></ul></li><li class="nav-item dropdown">Supplemental <ul class="nav-dropdown blue-light"><li class="nav-item"><a class="nav-link" href="/supplement-a1.html"><span>Supplement A1</span></a></li><li class="nav-item"><a class="nav-link" href="/supplement-a2.html"><span>Supplement A2</span></a></li><li class="nav-item"><a class="nav-link" href="/supplement-a3.html"><span>Supplement A3</span></a></li><li class="nav-item"><a class="nav-link" href="/supplement-a4.html"><span>Supplement A4</span></a></li><li class="nav-item"><a class="nav-link" href="/supplement-b1.html"><span>Supplement B1</span></a></li><li class="nav-item"><a class="nav-link" href="/supplement-b2.html"><span>Supplement B2</span></a></li><li class="nav-item"><a class="nav-link" href="/supplement-b3.html"><span>Supplement B3</span></a></li><li class="nav-item"><a class="nav-link" href="/supplement-b4.html"><span>Supplement B4</span></a></li><li class="nav-item"><a class="nav-link" href="/supplement-b5.html"><span>Supplement B5</span></a></li><li class="nav-item"><a class="nav-link" href="/supplement-b6.html"><span>Supplement B6</span></a></li><li class="nav-item"><a class="nav-link" href="/supplement-b7.html"><span>Supplement B7</span></a></li><li class="nav-item"><a class="nav-link" href="/supplement-b8.html"><span>Supplement B8</span></a></li><li class="nav-item"><a class="nav-link" href="/supplement-b9.html"><span>Supplement B9</span></a></li><li class="nav-item"><a class="nav-link" href="/supplement-b10.html"><span>Supplement B10</span></a></li><li class="nav-item"><a class="nav-link" href="/supplement-c1.html"><span>Supplement C1</span></a></li><li class="nav-item"><a class="nav-link" href="/supplement-c2.html"><span>Supplement C2</span></a></li><li class="nav-item"><a class="nav-link" href="/supplement-c3.html"><span>Supplement C3</span></a></li><li class="nav-item"><a class="nav-link" href="/supplement-d1.html"><span>Supplement D1</span></a></li><li class="nav-item"><a class="nav-link" href="/supplement-d2.html"><span>Supplement D2</span></a></li><li class="nav-item"><a class="nav-link" href="/supplement-d3.html"><span>Supplement D3</span></a></li><li class="nav-item"><a class="nav-link" href="/supplement-d4.html"><span>Supplement D4</span></a></li><li class="nav-item"><a class="nav-link" href="/supplement-d5.html"><span>Supplement D5</span></a></li><li class="nav-item"><a class="nav-link" href="/supplement-d6.html"><span>Supplement D6</span></a></li><li class="nav-item"><a class="nav-link" href="/supplement-d7a.html"><span>Supplement D7a</span></a></li><li class="nav-item"><a class="nav-link" href="/supplement-d7b.html"><span>Supplement D7b</span></a></li><li class="nav-item"><a class="nav-link" href="/supplement-d8.html"><span>Supplement D8</span></a></li><li class="nav-item"><a class="nav-link" href="/supplement-d9.html"><span>Supplement D9</span></a></li><li class="nav-item"><a class="nav-link" href="/supplement-d10.html"><span>Supplement D10</span></a></li></ul></li><li class="nav-item dropdown"> <a class="nav-link" href="/dev_info.html"><span>Developer Info</span></a><ul class="nav-dropdown blue-light"><li class="nav-item"><a class="nav-link" href="/GetVelma_ForEclipse.html"><span>Clone Github to Local Machine</span></a></li><li class="nav-item"><a class="nav-link" href="/CellSpecificBurnDisturbance_Configuration_Guide.html"><span>Cell Specific Burn Disturbance Config Guide</span></a></li><li class="nav-item"><a class="nav-link" href="/Configuration_Checker_Guide.html"><span>Configuration Checker Guide</span></a></li><li class="nav-item"><a class="nav-link" href="/DefaultSedimentModel_Configuration_Guide.html"><span>Default Sediment Model Config Guide</span></a></li><li class="nav-item"><a class="nav-link" href="/ForestBurnLsrDisturbanceModel_Overview.html"><span>Forest Burn LSR Disturbance Model</span></a></li><li class="nav-item"><a class="nav-link" href="/JPDEM_ReachMapping_Demonstration.html"><span>JPDEM Reaching Mapping Demo</span></a></li><li class="nav-item"><a class="nav-link" href="/MinMaxAirT_WeatherDrivers.html"><span>Min Max Air Temp Weather Drivers</span></a></li><li class="nav-item"><a class="nav-link" href="/ModifySpatialDataByMap_Guide.html"><span>Modify Spatial Data by Map Guide</span></a></li><li class="nav-item"><a class="nav-link" href="/ObsRunoff_and_NaNs.html"><span>OBS Runnoff and NaNs</span></a></li><li class="nav-item"><a class="nav-link" href="/OrganicContaminant_Overview.html"><span>Organic Contaminant Overview</span></a></li><li class="nav-item"><a class="nav-link" href="/OrganicContaminant_Remediation_Configuration_Guide.html"><span>Organic Contaminant Redemption Config Guide</span></a></li><li class="nav-item"><a class="nav-link" href="/OrganicContaminant_Tracer_Configuration_Guide.html"><span>Organic Contaminant Tracter Config Guide</span></a></li><li class="nav-item"><a class="nav-link" href="/ReachSpecificObservedRunnoff.html"><span>Reach Specific Observed Runnoff</span></a></li><li class="nav-item"><a class="nav-link" href="/Sediment_Output_Data_Summary.html"><span>Sediment Output Data Summary</span></a></li><li class="nav-item"><a class="nav-link" href="/SnowDepth_Initialization_Guide.html"><span>Snow Depth Initialization Guide</span></a></li></ul></li><li class="nav-item dropdown"> <a class="nav-link" href="/dev_utils.html"><span>Developer Utils</span></a><ul class="nav-dropdown blue-light"><li class="nav-item"><a class="nav-link" href="/AscMapOct_Guide.html"><span>Ascii Map Oct Guide </span></a></li><li class="nav-item"><a class="nav-link" href="/AscRangeMask_Guide.html"><span>Ascii Range Mask Guide</span></a></li><li class="nav-item"><a class="nav-link" href="/MoeVelGenerator_Guide.html"><span>MOEA-to-VELMA Configuration Generator</span></a></li><li class="nav-item"><a class="nav-link" href="/NashSutcliffeCalculator_Guide.html"><span>Tool for Computing Nash-Sutcliffe Coefficients</span></a></li><li class="nav-item"><a class="nav-link" href="/NseQuarts_Guide.html"><span>NseQuarts Guide</span></a></li><li class="nav-item"><a class="nav-link" href="/VelmaSimRunner_QuickRef.html"><span>VelmaSimRunner Quick Reference</span></a></li><li class="nav-item"><a class="nav-link" href="/VelmaSimRunner.html"><span>VelmaSimRunner Full Guide</span></a></li></ul></li></ul></nav></div><div class="main_body container"><h1>D.3 | Initialize a Spatial Data Pool Using an Ascii Grid</h1><div class="info blue-light-1"><p>Overview (Tutorial D.3 - Initialize a Spatial Data Pool Using an Ascii Grid)</p><p>VELMA is a spatially-distributed model, with each grid cell within a watershed representing a soil column and vegetation with characteristics that can vary greatly in space, reflecting variations in geology, land cover, land use and many other factors.</p><p>Before VELMA can reasonably simulate cell-to-cell transfers of water and chemicals within a real- world watershed, all supporting soil and vegetation spatial data must be initialized for day 1 of the simulation.</p><p>This tutorial describes the basic procedure for initializing soil and vegetation spatial data pools that use an Ascii grid of the same size and georeferencing as the DEM.</p></div><h2>General Procedure</h2><p>VELMA Simulator spatial data pools may be initialized by specifying "Set Spatial Data By Map" disturbances as part of a simulator run's simulation configuration. Each spatial data pool (and each layer of that pool for multi-layer pools) that is initialized must have a separate disturbance specified for it, and its own Grid Ascii (.asc) map file available for the disturbance to use as a data source1.</p><p>Assuming an otherwise already configured VELMA application, load the configuration (XML file) into JVelma. To initialize a spatial data pool (using the leaf biomass pool as our example), add a "Set Spatial Data By Map" disturbance event to the configuration:</p><h4>Note</h4><p>It's assumed that before configuring the simulation, you've already created a Grid Ascii map file (.asc) for the disturbance to use. How you create the map is up to you, but it must in standard Grid Ascii format, and have the same dimensions as the Grid Ascii map of DEM data that the simulation will use. For this example, each cell value in the Grid Ascii map file is assumed to be an amount of leaf biomass (in grams per square meter).</p><p>Add the New Disturbance Parameters to the Simulation Configuration</p><ol> <li>In JVelma, with the simulation configuration loaded, Click/open the "Edit" menu and Click/Select "Disturbances " -&gt; "Add a Disturbance".</li><li>In the Disturbance Model Selector dialog, use the drop-down selector to find the "SetSpatialDataByMapDisturbanceModel" and Click/Set it as the Disturbance Type.</li><li>In the text box next to the "DisturbanceName" prompt, type in a name for this particular disturbance. The name should be unique (the dialog will warn you if you enter a name already in use) and it is better to avoid whitespace and non-alphanumeric characters. For this is example, the name will be "Init_Leaf_Biomass".</li><li>Click the "OK" button. The dialog closes, the parameters for a new Set Spatial Data By Map disturbance are added to the simulation configuration, and the view should shift to these new parameters in JVelma's "All Parameters" tab window.</li></ol><p>1 Two or more Set Spatial Data By Map disturbances may be set to use the same Grid Ascii map file as their input data source, but it's more likely that a given spatial data pool to have its own unique input data source.</p><h2>Configure the New Disturbance Parameters</h2><p>The parameters for the Set Spatial Data By Map disturbance tell the disturbance when it should occur, What its data source is, and Which Spatial Data Pool to apply that data source to.</p><p>The initializeActiveLoops, initializeActiveYears" and initializeActiveJdays parameters, plus the occursAtStepStart parameter specify when this disturbance should occur. To initialize the leaf biomass pool before any simulation steps, set them as follows:</p><table><tr><td>Parameter Name</td><td>Set Value As …</td><td>Comment</td></tr><tr><td>initializeActiveLoops</td><td>1</td><td>Occurs during the first loop</td></tr><tr><td>initializeActiveYears</td><td>2000</td><td>Assumes 2000 is the simulation's start year</td></tr><tr><td>initializeActiveJdays</td><td>1</td><td>Occurs during the first Julian day</td></tr><tr><td>occursAtStepStart</td><td>true</td><td>Disturbance will occur before any simulation work is performed on the day when it occurs</td></tr></table><p>Set the spatialDataFileFullName parameter to the fully-qualified path and name of the Grid Ascii file that you plan to use as the input data source for biomass leaf values.</p><p>For this example, suppose that file is named "LeafBiomassData.asc" and resides in directory "C:\My Data\". The spatialDataFileName value should then be set to: "C:/My Data/LeafBiomassData.asc" (without the double-quotes).</p><h4>Note</h4><p>Instead of Windows backslash "\" path separators, use forward slash "/" characters as path separators. Also, be very careful with whitespace; if there is any, it must <i>exactly </i>match whatever whitespace is present in the actual path and filename.</p><p>Set the spatialDataName parameter to the Spatial Data Pool that will receive data from the file. For our example of leaf biomass, the pool name is "BIOMASS_LEAF_N" (without the double-quotes). <i><b>Note</b></i></p><p>A table containing the names of the Velma Simulator's spatial data pools is available at the end of this document.</p><p>Set the spatialDataLayer parameter to the (one-based) layer index number of the spatial data pool layer that will receive data from the file.</p><p>For single-layer spatial data pools this value MUST be set to "1" see the table of spatial data at the end of this document for a summary of how many layers each pool has.</p><p>In summary, here is the full parameterization for our example Set (Leaf Biomass) Spatial Data Pool By Map disturbance:</p><table><tr><td>ID Key</td><td>Value</td></tr><tr><td>/disturbance/Init_Leaf_Biomass/initializeActiveJdays</td><td>1</td></tr><tr><td>/disturbance/Init_Leaf_Biomass/initializeActiveLoops</td><td>1</td></tr><tr><td>/disturbance/Init_Leaf_Biomass/initializeActiveYears</td><td>2000</td></tr><tr><td>/disturbance/Init_Leaf_Biomass/modelClass</td><td>SetSpatialDataByMapDisturbanceModel</td></tr><tr><td>/disturbance/Init_Leaf_Biomass/occursAtStepStart</td><td>true</td></tr><tr><td>/disturbance/Init_Leaf_Biomass/spatialDataFileFullName</td><td>C:/My Data/LeafBiomassData.asc</td></tr><tr><td>/disturbance/Init_Leaf_Biomass/spatialDataLayer</td><td>1</td></tr><tr><td>/disturbance/Init_Leaf_Biomass/spatialDataName</td><td>BIOMASS_LEAF_N</td></tr></table><p>Configured as specified by the parameters above, this SetSpatialDataByMapDisturbanceModel disturbance occurs once during the simulation; in the first loop, on the first day of 2000 (assumed to be the first year of simulation for our example) and before any simulation work is done on that day.</p><p>When the disturbance occurs, it will open the Grid Ascii spatial data file</p><p>"C:/My Data/LeafBiomassdata.asc", and set each cell of the BIOMASS_LEAF_N spatial data pool in layer</p><p>1 to the value for that cell read from the .asc spatial data file.</p><p>That's all there is to it!</p><p>Although SetSpatialDataByMapDisturbanceModel disturbances may be used for other purposes, by varying when they occur, this example shows the commonest use-case; initializing specific non- uniform values into a spatial data pool at the start of a simulation.</p><h3>Caveat</h3><p>There is no cross-checking of user-specified SetSpatialDataByMapDisturbanceModel disturbances. This means that it is possible to configure a simulation with multiple SetSpatialDataByMapDisturbanceModel disturbances targeting a single spatial data pool. In such circumstances, all multiple maps' values are applied to a single pool in succession, and the last map's values are the pool's "initialization". However, it is not possible to specify the sequence for the application of the multiple maps; hence what the pool is actually initialized to is ill-defined.</p><p>Cross-checking is automatically performed when the simulator's setStartStateSpatialDataFullDir parameter is specified, but under no other conditions.</p><p>The user, is therefore responsible for confirming that a collection of SetSpatialDataByMapDisturbanceModel distrubances do not "step on each other" with regard to the spatial data pools they modify.</p><p>A Partial List of Velma Simulator Spatial Data Pools (<i>see Tutorial D.8 for full list</i>)</p><table><tr><td> Spatial Data Pool Name</td><td> Layers</td><td> Unit Type</td></tr><tr><td>BIOMASS_AG_STEM_N</td><td>1</td><td>N g/m^2</td></tr><tr><td>BIOMASS_BG_STEM_N</td><td>1</td><td>N g/m^2</td></tr><tr><td>BIOMASS_DELTA_AG_STEM_N</td><td>1</td><td>N g/m^2</td></tr><tr><td>BIOMASS_DELTA_BG_STEM_N</td><td>1</td><td>N g/m^2</td></tr><tr><td>BIOMASS_DELTA_LEAF_N</td><td>1</td><td>N g/m^2</td></tr><tr><td>BIOMASS_DELTA_ROOT_N</td><td>1</td><td>N g/m^2</td></tr><tr><td>BIOMASS_HARVESTED_TO_OFFSITE_C</td><td>1</td><td>C g/m^2</td></tr><tr><td>BIOMASS_LEAF_N</td><td>1</td><td>N g/m^2</td></tr><tr><td>BIOMASS_ROOT_N</td><td>4</td><td>N g/m^2</td></tr><tr><td>CO2</td><td>4</td><td>Carbon</td></tr><tr><td>DENITRIFICATION</td><td>4</td><td>N g/m^2</td></tr><tr><td>DETRITUS_AG_STEM_N</td><td>1</td><td>N g/m^2</td></tr><tr><td>DETRITUS_BG_STEM_N</td><td>4</td><td>N g/m^2</td></tr><tr><td>DETRITUS_BURNED_C</td><td>1</td><td>C g/m^2</td></tr><tr><td>DETRITUS_LEAF_N</td><td>1</td><td>N g/m^2</td></tr><tr><td>DETRITUS_ROOT_N</td><td>4</td><td>N g/m^2</td></tr><tr><td>DOC</td><td>4</td><td>C g/m^2</td></tr><tr><td>DON</td><td>4</td><td>N g/m^2</td></tr><tr><td>GROUND_SURFACE_TEMPERATURE</td><td>1</td><td>Degrees C</td></tr><tr><td>GROUND_TEMPERATURE_LAYERS</td><td>4</td><td>Degrees C</td></tr><tr><td>HUMUS</td><td>4</td><td>N g/m^2</td></tr><tr><td>NH4</td><td>4</td><td>N g/m^2</td></tr><tr><td>NITRIFICATION</td><td>4</td><td>N g/m^2</td></tr><tr><td>NO3</td><td>4</td><td>N g/m^2</td></tr><tr><td>NPP_C</td><td>1</td><td>C g/m^2</td></tr><tr><td>NPP_N</td><td>1</td><td>N g/m^2</td></tr><tr><td>UPTAKE_N</td><td>4</td><td>N g/m^2</td></tr></table></div></body><footer id="footer"><p>VELMA 2.2 DOCUMENTATION</p></footer></html>