<!DOCTYPE html>
<html>

<head>
  <meta name="viewport" content="width=device-width">
  <meta name="charset" content="utf-8">
  <link rel="stylesheet" type="text/css" href="/style.css">
  <title></title>

<body class="bg-primary">
  <div class="header blue-base">
    <nav class="navbar blue-base navbar-expand"><a class="navbar-brand" href="/index.html">VELMA 2.2 HOME</a>
      <ul class="navbar-nav no-bullets">
        <li class="nav-item"><a class="nav-link" href="/intro.html"><span>I. Intro</span></a></li>
        <li class="nav-item"><a class="nav-link" href="/changes.html"><span>II. Changes from 1.0</span></a></li>
        <li class="nav-item"><a class="nav-link" href="/about.html"><span>III. About</span></a></li>
        <li class="nav-item"><a class="nav-link" href="/input_files.html"><span>IV. Input Files </span></a></li>
        <li class="nav-item"><a class="nav-link" href="/new_sim_config.html"><span>V. Sim Config</span></a></li>
        <li class="nav-item"><a class="nav-link" href="/parameter_config.html"><span>VI. Parameter Config</span></a></li>
        <li class="nav-item dropdown">Appendicies<ul class="nav-dropdown blue-light">
            <li class="nav-item"><a class="nav-link" href="/appendix_1.html"><span>Appendix 1</span></a></li>
            <li class="nav-item"><a class="nav-link" href="/appendix_2.html"><span>Appendix 2</span></a></li>
            <li class="nav-item"><a class="nav-link" href="/appendix_3.html"><span>Appendix 3</span></a></li>
            <li class="nav-item"><a class="nav-link" href="/appendix_4.html"><span>Appendix 4</span></a></li>
            <li class="nav-item"><a class="nav-link" href="/appendix_5.html"><span>Appendix 5</span></a></li>
            <li class="nav-item"><a class="nav-link" href="/appendix_6.html"><span>Appendix 6</span></a></li>
            <li class="nav-item"><a class="nav-link" href="/appendix_7.html"><span>Appendix 7</span></a></li>
          </ul>
        </li>
        <li class="nav-item dropdown">Supplemental <ul class="nav-dropdown blue-light">
            <li class="nav-item"><a class="nav-link" href="/supplement-a1.html"><span>Supplement A1</span></a></li>
            <li class="nav-item"><a class="nav-link" href="/supplement-a2.html"><span>Supplement A2</span></a></li>
            <li class="nav-item"><a class="nav-link" href="/supplement-a3.html"><span>Supplement A3</span></a></li>
            <li class="nav-item"><a class="nav-link" href="/supplement-a4.html"><span>Supplement A4</span></a></li>
            <li class="nav-item"><a class="nav-link" href="/supplement-b1.html"><span>Supplement B1</span></a></li>
            <li class="nav-item"><a class="nav-link" href="/supplement-b2.html"><span>Supplement B2</span></a></li>
            <li class="nav-item"><a class="nav-link" href="/supplement-b3.html"><span>Supplement B3</span></a></li>
            <li class="nav-item"><a class="nav-link" href="/supplement-b4.html"><span>Supplement B4</span></a></li>
            <li class="nav-item"><a class="nav-link" href="/supplement-b5.html"><span>Supplement B5</span></a></li>
            <li class="nav-item"><a class="nav-link" href="/supplement-b6.html"><span>Supplement B6</span></a></li>
            <li class="nav-item"><a class="nav-link" href="/supplement-b7.html"><span>Supplement B7</span></a></li>
            <li class="nav-item"><a class="nav-link" href="/supplement-b8.html"><span>Supplement B8</span></a></li>
            <li class="nav-item"><a class="nav-link" href="/supplement-b9.html"><span>Supplement B9</span></a></li>
            <li class="nav-item"><a class="nav-link" href="/supplement-b10.html"><span>Supplement B10</span></a></li>
            <li class="nav-item"><a class="nav-link" href="/supplement-c1.html"><span>Supplement C1</span></a></li>
            <li class="nav-item"><a class="nav-link" href="/supplement-c2.html"><span>Supplement C2</span></a></li>
            <li class="nav-item"><a class="nav-link" href="/supplement-c3.html"><span>Supplement C3</span></a></li>
            <li class="nav-item"><a class="nav-link" href="/supplement-d1.html"><span>Supplement D1</span></a></li>
            <li class="nav-item"><a class="nav-link" href="/supplement-d2.html"><span>Supplement D2</span></a></li>
            <li class="nav-item"><a class="nav-link" href="/supplement-d3.html"><span>Supplement D3</span></a></li>
            <li class="nav-item"><a class="nav-link" href="/supplement-d4.html"><span>Supplement D4</span></a></li>
            <li class="nav-item"><a class="nav-link" href="/supplement-d5.html"><span>Supplement D5</span></a></li>
            <li class="nav-item"><a class="nav-link" href="/supplement-d6.html"><span>Supplement D6</span></a></li>
            <li class="nav-item"><a class="nav-link" href="/supplement-d7a.html"><span>Supplement D7a</span></a></li>
                        <li class="nav-item"><a class="nav-link" href="/supplement-d7b.html"><span>Supplement D7b</span></a></li>
            <li class="nav-item"><a class="nav-link" href="/supplement-d8.html"><span>Supplement D8</span></a></li>
            <li class="nav-item"><a class="nav-link" href="/supplement-d9.html"><span>Supplement D9</span></a></li>
            <li class="nav-item"><a class="nav-link" href="/supplement-d10.html"><span>Supplement D10</span></a></li>
          </ul>
        </li>
        <li class="nav-item dropdown"> <a class="nav-link" href="/dev_info.html"><span>Developer Info</span></a>
          <ul class="nav-dropdown blue-light">
            <li class="nav-item"><a class="nav-link" href="/GetVelma_ForEclipse.html"><span>Clone Github to Local Machine</span></a></li>
            <li class="nav-item"><a class="nav-link" href="/CellSpecificBurnDisturbance_Configuration_Guide.html"><span>Cell Specific Burn Disturbance Config Guide</span></a></li>
            <li class="nav-item"><a class="nav-link" href="/Configuration_Checker_Guide.html"><span>Configuration Checker Guide</span></a></li>
            <li class="nav-item"><a class="nav-link" href="/DefaultSedimentModel_Configuration_Guide.html"><span>Default Sediment Model Config Guide</span></a></li>
            <li class="nav-item"><a class="nav-link" href="/ForestBurnLsrDisturbanceModel_Overview.html"><span>Forest Burn LSR Disturbance Model</span></a></li>
            <li class="nav-item"><a class="nav-link" href="/JPDEM_ReachMapping_Demonstration.html"><span>JPDEM Reaching Mapping Demo</span></a></li>
            <li class="nav-item"><a class="nav-link" href="/MinMaxAirT_WeatherDrivers.html"><span>Min Max Air Temp Weather Drivers</span></a></li>
            <li class="nav-item"><a class="nav-link" href="/ModifySpatialDataByMap_Guide.html"><span>Modify Spatial Data by Map Guide</span></a></li>
            <li class="nav-item"><a class="nav-link" href="/ObsRunoff_and_NaNs.html"><span>OBS Runnoff and NaNs</span></a></li>
            <li class="nav-item"><a class="nav-link" href="/OrganicContaminant_Overview.html"><span>Organic Contaminant Overview</span></a></li>
            <li class="nav-item"><a class="nav-link" href="/OrganicContaminant_Remediation_Configuration_Guide.html"><span>Organic Contaminant Redemption Config Guide</span></a></li>
            <li class="nav-item"><a class="nav-link" href="/OrganicContaminant_Tracer_Configuration_Guide.html"><span>Organic Contaminant Tracter Config Guide</span></a></li>
            <li class="nav-item"><a class="nav-link" href="/ReachSpecificObservedRunnoff.html"><span>Reach Specific Observed Runnoff</span></a></li>
            <li class="nav-item"><a class="nav-link" href="/Sediment_Output_Data_Summary.html"><span>Sediment Output Data Summary</span></a></li>
            <li class="nav-item"><a class="nav-link" href="/SnowDepth_Initialization_Guide.html"><span>Snow Depth Initialization Guide</span></a></li>
          </ul>
        </li>
        <li class="nav-item dropdown"> <a class="nav-link" href="/dev_utils.html"><span>Developer Utils</span></a>
          <ul class="nav-dropdown blue-light">
            <li class="nav-item"><a class="nav-link" href="/AscMapOct_Guide.html"><span>Ascii Map Oct Guide </span></a></li>
            <li class="nav-item"><a class="nav-link" href="/AscRangeMask_Guide.html"><span>Ascii Range Mask Guide</span></a></li>
            <li class="nav-item"><a class="nav-link" href="/MoeVelGenerator_Guide.html"><span>MOEA-to-VELMA Configuration Generator</span></a></li>
            <li class="nav-item"><a class="nav-link" href="/NashSutcliffeCalculator_Guide.html"><span>Tool for Computing Nash-Sutcliffe Coefficients</span></a></li>
            <li class="nav-item"><a class="nav-link" href="/NseQuarts_Guide.html"><span>NseQuarts Guide</span></a></li>
            <li class="nav-item"><a class="nav-link" href="/VelmaSimRunner_QuickRef.html"><span>VelmaSimRunner Quick Reference</span></a></li>
            <li class="nav-item"><a class="nav-link" href="/VelmaSimRunner.html"><span>VelmaSimRunner Full Guide</span></a></li>
          </ul>
        </li>
      </ul>
    </nav>
  </div>
  <div class="main_body">
    <div class="container">
      <h1>VELMA Surface Evaporation</h1>
      <h2>Overview</h2>
      <p>VELMA version 2.2.0.0 supports the inclusion of Surface Evaporation as part of simulation configurations.<br>
        When Surface Evaporation is included in a simulation run, evaporation amounts are calculated during each simulation step at each cell, and the calculated amounts of evaporated water are removed from the cell (and the simulation state).
        Water removed by surface evaporation is reported in Daily and Cell-specific .csv files of the simulation's results folder. Additionally, spatial-data writers may be configured to report evaporation amounts in <code>.asc</code> map files.</p>
      <h3>Important: Additional Driver Data Requirement</h3>
      <p>Calculating surface evaporation involves dew point, and VELMA's Surface Evaporation code uses minimum air temperature as an approximate value for dew point.
        Therefore, <strong>any VELMA simulation configuration that includes Surface Evaporation must also include per-step minumum air temperature values as part of the driver data for its weather model</strong>.<br>
        Miniumum air temperature values are not required for VELMA simulation configuration <em>without</em> Surface Evaporation, but simulations configured <em>with</em> Surface Evaporation <em>must</em> provide miniumum air temperature driver data: without it, the simulation run will halt and fail during the first simulation step.<br>
        See the <a href="#dew-point-and-dew-point-correction">Dewpoint and Dewpoint Correction</a> section of this document for how to provide minimum air temperature values to the simulation.</p>
      <h3>Adding Surface Evaporation to a VELMA Configuration</h3>
      <p>Begin by loading a VELMA simulation configuration into JVelma, or by creating a new configuration from within JVelma (via the Edit -&gt; &quot;Create a New, Empty Configuration&quot; menu item).</p>
      <p>Next, click the Edit -&gt; &quot;Set Surface Evaporation Model&quot; to display the Surface Evaporation sub-menu.
        The Surface Evaporation sub-menu has two items: &quot;NO Surface Evaporation Model&quot; and &quot;Default Surface Evaporation Model&quot;.</p>
      <p><img src="public/image-JVelma_AddSurfaceEvaporation.PNG" alt="A screen-capture image illustrating the traversal to the JVelma menu item Edit, Set Surface Evaporation Model" title="The Set Surface Evaporation Model sub-menu"></p>
      <p>To add Surface Evaporation parameters to the current configuration, click the &quot;Default Surface Evaporation Model&quot; item.</p>
      <blockquote>
        <p><strong><em>Note:</em></strong> If the current configuration <em>already</em> contains Surface Evaporation parameters,
          clicking &quot;Default Surface Evaporation Model&quot; &quot;resets&quot; all existing Surface Evaporation parameters
          back to their default values.</p>
      </blockquote>
      <p>When you click &quot;Default Surface Evaporation Model&quot;, JVelma shifts display focus to the &quot;All Parameters&quot; tab, and filters the rows of the parameters table to those specific to Surface Evaporation.</p>
      <p><img src="public/image-JVelma_AllParameters_SurfaceEvaporation.PNG" alt="A screen-capture image of JVelma's All Parameters table, showing the Surface Evaporation parameters" title="JVelma Surface Evaporation Parameters"></p>
      <blockquote>
        <p>The current set of Surface Evaporation parameters is relatively small, and several of them should be left as-is, set to the values provided as defaults.</p>
      </blockquote>
      <h4><em>Parameters That Can (Should!) be Left Alone</em></h4>
      <p>The <code>modelClass</code> parameter is set by JVelma when you add the contaminant to the simulation configuration. Do Not Change this parameter’s value. <em>Ever</em>.</p>
      <p>The <code>uniqueName</code> parameter is automatically set to the rightmost name in the dot-separated sequence of the <code>modelClass</code> name and should be left as-is.</p>
      <p>The <code>uniqueId</code> parameter is generated automatically and should be left as-is.</p>
      <h4><em>Parameters That Affect Surface Evaporation Behavior</em></h4>
      <p>The <code>rainfallCutoff</code> parameter specifies the amount of recent rainfall (in mm) at a given cell necessary to trigger
        <a href="#dew-point-and-dew-point-correction">dew point correction</a> prior to calculating the cell's surface evaporation.
      </p>
      <pre><code>When recentRainfall &gt; rainfallCutoff --&gt; perform dew point correction.
</code></pre>
      <p>By default, this parameter's value is set to an &quot;impossibly high&quot; value, which effectively prohibits dew point correction.
        Be sure to change this parameter's value to something reasonable for your specific simulation configuration if you expect dew point correction to occur.</p>
      <p>The <code>setDewpointMtclimK</code> parameter provides a K-coefficient calibration parameter for the MTCLIM equation used to compute dew point correction.<br>
        The value of this parameter can be either a floating point number or the name of an <code>.asc</code> grid map file of cell-specific values.</p>
      <table>
        <thead>
          <tr>
            <th>parameter type</th>
            <th>example</th>
            <th>behavior</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>single value</td>
            <td><code>1.65</code></td>
            <td>Specified value is used as the dew point MTCLIM K-coefficient at all delineated cells</td>
          </tr>
          <tr>
            <td>map file name</td>
            <td><code>./m_1_DEM/dewpointK_values.asc</code></td>
            <td>Values in the specified file are used as cell-specific MTCLIM K-coefficient values.</td>
          </tr>
        </tbody>
      </table>
      <p>When <code>setDewpointMtclimK</code> is set to an <code>.asc</code> grid map file, the file may be specified by its name alone, its name and a partial path, or its name and a fully-qualified path.
        When a fully-qualified path is not specified, VELMA assumes the name or partial path + name is relative to the root input data directory specified by the configuration parameters <code>inputDataLocationRootName</code> and <code>inputDataLocationDirName</code>.</p>
      <p>An <code>.asc</code> grid map file used to provide data for the dew point K-coefficient calibration parameter must duplicate all of the DEM grid <code>.asc</code> file's header (<code>ncols</code>, <code>nrows</code>, etc.) values.</p>
      <p>It should also <em>not</em> contain <code>nodata_value</code> values, because the Surface Evporation code does screen out or replace <code>nodata_value</code>s in the <code>.asc</code> file.
        Any <code>nodata_value</code> value coinciding with a cell included in the simulation's delineated watershed will have the <code>nodata_value</code> value assigned as its MTMLIM K-coefficient.
        This is unlikely to be what was intended, and is difficult to detect if it occurs.</p>
      <h4><em>Parameters That Provide Additional Reporting Data</em></h4>
      <p>The <code>enableTraceCell</code> and <code>traceCellIndex</code> pair of parameters determine whether or not VELMA collects and reports
        <a href="#optional-detailed-reporting-for-configuration-calibration">extra Surface Evaporation calculation details</a>
        and the cell location those details are reported for.
      </p>
      <p>When <code>enableTraceCell</code> is set <code>true</code>, VELMA writes a log message containing Surface Evaporation details for the cell location specified by <code>traceCellIndex</code> to the global trace log .csv file specified by the VELMA <code>csvTraceLogFileName</code> parameter (default name &quot;GlobalTraceLog.csv&quot;).</p>
      <p>The <code>traceCellIndex</code> parameter's value can either be left unspecified, or be the linear cell index value of a cell within the watershed delineated for the simulation configuration.
        When it is left unspecified, VELMA will default to reporting details at the simulation configuration's specified outlet cell.</p>
      <table>
        <thead>
          <tr>
            <th><code>enableTraceCell</code></th>
            <th><code>traceCellIndex</code></th>
            <th>Outcome</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td><code>true</code></td>
            <td>blank</td>
            <td>outlet cell's surface ev. details logged to <code>csvTraceLogFileName</code> file.</td>
          </tr>
          <tr>
            <td><code>true</code></td>
            <td>cell index</td>
            <td>specified cell's surface ev. details logged to <code>csvTraceLogFileName</code> file.</td>
          </tr>
          <tr>
            <td><code>false</code></td>
            <td>blank</td>
            <td>no tracing written to trace .csv file.</td>
          </tr>
          <tr>
            <td><code>false</code></td>
            <td>cell index</td>
            <td>no tracing written to trace .csv file.</td>
          </tr>
        </tbody>
      </table>
      <p>The details reported can assist in understanding surface evaporation behavior during calibration, but reporting them costs a bit of additional running, and increases the size of the global trace log .csv file.
        For this reason, <code>enableTraceCell</code> is set <code>false</code> by default, and VELMA only reports details for a single cell location.</p>
      <h3>Removing Surface Evaporation from a VELMA Configuration</h3>
      <p>Clicking Edit -&gt; &quot;Set Surface Evaporation Model&quot; -&gt; &quot;NO Surface Evaporation Model&quot; <em>removes</em> any existing Surface Evaporation parameterization from the current configuration.
        When the current configuration has no existing Surface Evaporation parameters, clicking &quot;NO Surface Evaporation Model&quot; does nothing.</p>
      <h3>An Overview of Surface Evaporation's Behavior and Effect</h3>
      <h4><em>How are Surface Evaporation Amounts Calculated?</em></h4>
      <p>Surface Evaporation amounts are computed based on the technique described by Edward T. Linacre in his 1994 paper:<br>
        Linacre, Edward T. “Estimating U.S. Class A Pan Evaporation from Few Climate Data.” Water International, vol. 19, no. 1, 1994, pp. 5–14.</p>
      <p>Based on that paper, this is the equation VELMA uses:</p>
      <pre><code>ev = (0.015 + 0.00042 * temperature + 0.000001 * elevation) * (0.8 * irradiance - 40 + 2.5 * airDensityByElev * windSpeed * (temperature - dewPoint))
</code></pre>
      <p>The components of the formula are:</p>
      <table>
        <thead>
          <tr>
            <th>Component</th>
            <th>Description</th>
            <th>Cell-Specific?</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>0.015</td>
            <td><code>[ * ]</code></td>
            <td>no</td>
          </tr>
          <tr>
            <td>0.00042</td>
            <td><code>[ * ]</code></td>
            <td>no</td>
          </tr>
          <tr>
            <td>temperature</td>
            <td>average daily air temperature, degrees C</td>
            <td>configuration-dependent</td>
          </tr>
          <tr>
            <td>0.8</td>
            <td><code>[ * ]</code></td>
            <td>no</td>
          </tr>
          <tr>
            <td>irradiance</td>
            <td>solar irradiance in W/m^2</td>
            <td>configuration-dependent</td>
          </tr>
          <tr>
            <td>40</td>
            <td><code>[ * ]</code></td>
            <td>no</td>
          </tr>
          <tr>
            <td>2.5</td>
            <td><code>[ * ]</code></td>
            <td>no</td>
          </tr>
          <tr>
            <td>airDensityByElev</td>
            <td>change in air density with elevation</td>
            <td>yes</td>
          </tr>
          <tr>
            <td>windSpeed</td>
            <td>wind speed in m/sec at 2 meters above ground</td>
            <td>no</td>
          </tr>
          <tr>
            <td>dewPoint</td>
            <td>deg C</td>
            <td>configuration-dependent</td>
          </tr>
        </tbody>
      </table>
      <blockquote>
        <p>Note: Each <code>[ * ]</code> indicates a constant value for a term of the equation, as utilized by Linacre in the 1994 paper.<br>
          These values were derived by Linacre for his 1994 paper, based on his earlier 1993 paper:<br>
          Linacre, Edward T. “Data-Sparse Estimation of Lake Evaporation, Using a Simplified Penman Equation.” Agricultural and Forest Meteorology, vol. 64, no. 3, 1993, pp. 237–56.</p>
      </blockquote>
      <blockquote>
        <p>Note: &quot;configuration-dependent&quot; indicates the component may or may not be cell-specific, depending upon the VELMA simulation configuration and driver data in use.</p>
      </blockquote>
      <blockquote>
        <p>Note: Currently, VELMA hardwires windSpeed to the value 0.001.</p>
      </blockquote>
      <h4><em>How Does Surface Evaporation Affect Simulation State?</em></h4>
      <p>When the simulator calculates a Surface Evaporation amount greater than zero for a cell location, the cell's current SURFACE_LATERAL_OUTFLOW water amount is reduced by the calculated evaporation amount.
        When the calulated evaporation amount exceeds the cell's current SURFACE_LATERAL_OUTFLOW amount, the SURFACE_LATERAL_OUTFLOW is zeroed.
        SURFACE_LATERAL_OUTFLOW is the amount of water that VELMA's Water Balance mechanism has determined a cell will transfer to its downhill neighbors during the current simulation step.
        Therefore, Surface Evaporation has the overall effect of (slightly) reducing the water amounts moving across the watershed surface during a simulation run.
        Because surface water may penetrate (inflow) into a cell's soil layers, Surface Evaporation can indirectly affect the water balance of a cell's soil layers (by reducing the amount of surface water available for inflow).</p>
      <p>Surface Evaporation is a separate computation from VELMA's PET/ET calculation.
        Unlike Surface Evaporation, PET/ET is calculated against the water amounts in the four soil layers, may include leaf biomass as a calculation factor, and is itself a factor of VELMA's water balance difference equations.</p>
      <h4><em>When Does Surface Evaporation Occur?</em></h4>
      <p>Surface Evaporation amounts are computed individually for each cell, during each simulation step.
        Within the sequence of events that constitute a simulation step, Surface Evaporation is calculated <em>after</em> a cell's water balance is determined, but <em>before</em> transport of chemicals by lateral or vertical water movement is calculated. Surface Evaporation also occurs before water movement through drain pipes (if the simulation is configured with Water Drains).</p>
      <h4><em>Dew Point and Dew Point Correction</em></h4>
      <p>Dew point is one of factors required for caculating surface evaporation values, and VELMA's Surface Evaporation code uses minimum air temperature as an approximate value for dew point.
        Therefore, as <a href="#important-additional-driver-data-requirement">previously stated</a>, VELMA simulations configured for Surface Evaporation <strong>*must *</strong> include per-step minimum air temperature driver data, or the simulation will and fail during the first simulation step.</p>
      <p>See the
        <a href="../HowTo-MinMaxAirT_WeatherDrivers/MinMaxAirT_WeatherDrivers.html#overview">MinMaxAirT Weather Drivers Overview document</a>
        for a summary of VELMA weather model min/max air temperature support and how to provide driver data.
      </p>
      <p>When a simulation configuration additionally provides maximum air temperature driver data values for its weather model <em>and</em> a value or map for its
        <a href="#parameters-that-affect-surface-evaporation-behavior"><code>setDewpointMtclimK</code></a>
        parameter, VELMA's Surface Evaporation code can attempt to improve (&quot;correct&quot;) dew point values by setting them equal to the result of a MTCLIM model calculation.<br>
        However: keep in mind that even when all the necessary configuration/driver data is specified, dew point correction still occurs only when recent rainfall is greater than value of the
        <a href="#parameters-that-affect-surface-evaporation-behavior"><code>rainfallCutoff</code></a>
        parameter.<br>
        I.e.
      </p>
      <pre><code>When (Has max airT driver data) AND (Has setDewpointMtclimK value) AND (recentRainfall &gt; rainfallCutoff) --&gt; dew point correction is computed.
</code></pre>
      <h3>Simulation Results for Surface Evaporation</h3>
      <h4><em>Basic Evaporation Results</em></h4>
      <p>When a VELMA simulation configuration includes Surface Evaporation, VELMA's DailyResults.csv and AnnualResults.csv files, along with any specified Cell-writer .csv files, include columns reporting per-step surface evaporation amounts.</p>
      <p>In DailyResults.csv and AnnualResults.csv, the current column name for Surface Evaporation values is:</p>
      <pre><code>Surface_Evaporation(mm/day)_Delineated_Average
</code></pre>
      <p>In Cell-writer .csv files, the current column name for Surface Evaporation values is:</p>
      <pre><code>Surface_Evaporation(mm/day)
</code></pre>
      <p>Surface Evaporation-specific data columns are <em>not</em> included in VELMA results files when Surface Evaporation is not part of the simulation configuration.</p>
      <h4><em>Optional, Detailed Reporting for Configuration Calibration</em></h4>
      <p>When the Surface Evaporation <a href="#parameters-that-provide-additional-reporting-data"><code>enableTraceCell</code></a>
        parameter is set <code>true</code>, VELMA writes a location-specific log message containing evaporation calculation details for each simulation step to the <code>csvTraceLogFileName</code> (default name &quot;GlobalTraceLog.csv&quot;) <code>.csv</code> results file. The log messages report details of the surface evaporation calculation at every simulation step, but only for a single cell location, specified by the
        <a href="#parameters-that-provide-additional-reporting-data"><code>traceCellIndex</code></a> parameter.
      </p>
      <p>A header log message for the trace data is also written; it looks like this:</p>
      <pre><code>FINEST,doSurfaceEvaporationAtCell,Loop,Step,Year,Jday,iCell,elevation,airDensityByElev,aveTemperature,minTemperature,maxTemperature,irradiance,recentRainfall,todayRain,rainfallCutoff,dewpointMtclimK,mtclimVal,dewPoint,T1_surfaceLateralOutFlow,evapo,actualEvapo,diff(evapo - actualEvapo),T2_surfaceEvaporation,T2_surfaceLateralOutFlow
</code></pre>
      <table>
        <thead>
          <tr>
            <th>Column Header</th>
            <th>Description</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>FINEST</td>
            <td>The logging level of the data.</td>
          </tr>
          <tr>
            <td>doSurfaceEvaporationAtCell</td>
            <td>The VELMA code that created the data.</td>
          </tr>
          <tr>
            <td>Loop</td>
            <td>The simulation loop when this row of data was written.</td>
          </tr>
          <tr>
            <td>Step</td>
            <td>The simulation step (zero-based) when this row of data was written.</td>
          </tr>
          <tr>
            <td>Year</td>
            <td>The simulation year when this row of data was written.</td>
          </tr>
          <tr>
            <td>Jday</td>
            <td>The Julian day of the year when this row of data was written.</td>
          </tr>
          <tr>
            <td>iCell</td>
            <td>The location (linear cell index) that this data is for.</td>
          </tr>
          <tr>
            <td>elevation</td>
            <td>The elevation (in meters) of iCell.</td>
          </tr>
          <tr>
            <td>airDensityByElev</td>
            <td>The air density used in the evaporation calculation.</td>
          </tr>
          <tr>
            <td>aveTemperature</td>
            <td>iCell's average air temperature (in degrees C)</td>
          </tr>
          <tr>
            <td>minTemperature</td>
            <td>iCell's minimun air temperature (in degrees C)</td>
          </tr>
          <tr>
            <td>maxTemperature</td>
            <td>iCell's maximum air temperature (in degrees C). A value of <code>NaN</code> indicates maximum air temperature driver data was unavailable.</td>
          </tr>
          <tr>
            <td>irradiance</td>
            <td>iCell's irradiance (in Watts/m^2)</td>
          </tr>
          <tr>
            <td>recentRainfall</td>
            <td>The amount (in mm) of recent rainfall. (Currently, &quot;recent&quot; means rainfall on the previous day).</td>
          </tr>
          <tr>
            <td>todayRain</td>
            <td>The amount (in mm) of rainfall for the current simulation Step, at this iCell.</td>
          </tr>
          <tr>
            <td>rainfallCutoff</td>
            <td>The value specified for the <code>rainfallCutoff</code> parameter.</td>
          </tr>
          <tr>
            <td>dewpointMtclimK</td>
            <td>The value specified for the setDewPointMtclimK parameter either directly or via .asc map file at this iCell. A value of <code>NaN</code> indicates the parameter was left blank.</td>
          </tr>
          <tr>
            <td>mtclimVal</td>
            <td>The MTCLIM value calculated as the corrected dew point value for this cell. A value of <code>NaN</code> <em>may</em> indicate no mctlimVal was computed, <em>or</em> that a specific value computed to <code>NaN</code>.</td>
          </tr>
          <tr>
            <td>dewPoint</td>
            <td>The dew point value used in the evaporation calculation.</td>
          </tr>
          <tr>
            <td>T1_surfaceLateralOutFlow</td>
            <td>The amount of water (in mm) available in the surface lateral outflow pool for this cell, at this simulation step, <em>before</em> evaporation takes place.</td>
          </tr>
          <tr>
            <td>evapo</td>
            <td>The amount of water calculated as evaporated for iCell at the current simulation Step.</td>
          </tr>
          <tr>
            <td>actualEvapo</td>
            <td>The amount of water actually evaporated (removed from the surface lateral outflow pool) at iCell for this simulation Step.</td>
          </tr>
          <tr>
            <td>diff(evapo - actualEvapo)</td>
            <td>The difference between the two prior values, calculated as shown in the header text.</td>
          </tr>
          <tr>
            <td>T2_surfaceEvaporation</td>
            <td>The amount of water (in mm) calculated as evaporated -- should match the &quot;actualEvapo&quot; value.</td>
          </tr>
          <tr>
            <td>T2_surfaceLateralOutFlow</td>
            <td>The amount of water (in mm) remaining in the surface lateral outflow pool after it is reduced by the calculated evaporation amount.</td>
          </tr>
        </tbody>
      </table>
      <h4><em>Configuring Spatial Data Writers for Surface Evaporation</em></h4>
      <p>VELMA simulations configured with Surface Evaporation can report spatially-explicit evaporation amounts as part of simulation run results by configuring a Spatial Data Writer to capture <code>SURFACE_EVAPORATION</code>.</p>
      <p>Here is an example spatial data parameterization:</p>
      <pre><code>/spatialDataWriter/SurfaceEv/allowNonWatershedCellValues, false
/spatialDataWriter/SurfaceEv/initializeActiveInterval,
/spatialDataWriter/SurfaceEv/initializeActiveJdays, 1
/spatialDataWriter/SurfaceEv/initializeActiveLoops, 1
/spatialDataWriter/SurfaceEv/initializeActiveYears, 1980
/spatialDataWriter/SurfaceEv/initializeResultsLocation, ./SpatialResults
/spatialDataWriter/SurfaceEv/initializeSpatialDataSources, SURFACE_EVAPORATION
/spatialDataWriter/SurfaceEv/modelClass, SpatialDataWriter
/spatialDataWriter/SurfaceEv/trimOutputToWatershedBoundary, false
</code></pre>
      <p>Other simulation configurations could select different timing or trimming values.
        Only the <code>initializeSpatialDataSources</code> parameter's value is invariant: it <em>must</em> be set to <code>SURFACE_EVAPORATION</code> for the Spatial Data Writer to successfully report surface evaporation data values.</p>
      <h3>The Surface Evaporation Runtime Display</h3>
      <p>When VELMA simulation configurations include Surface Evaporation, the JVelma GUI's &quot;Chart&quot; provides a basic runtime display option.<br>
        After starting a simulation run in JVelma, in the &quot;Chart&quot; tab, click the drop-down display selector to list the available chart types, and click-select &quot;Surface Evaporation&quot;.
        (Note: &quot;Surface Evaporation&quot; only appears in the drop-down if the running simulation configuration includes Surface Evaporation.)</p>
      <p>The Surface Evaporation display provides spatially-explicit views of current surface evaporation values and surface later outflow amounts, as well as daily average temporal charting for the same.</p>
      <p><img src="public/image-JVelma_SurfaceEvaporation_RuntimeDisplay.PNG" alt="A screen-capture image snapshot of the JVelma Surface Evaporation display durnig a simulation run" title="The JVelma Surface Evaporation runtime display"></p>
      <p>The display panel color-range min/max values are specified by the following configuration parameters:</p>
      <table>
        <thead>
          <tr>
            <th>Parameter Name</th>
            <th>Defines?</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>minSurfaceEvaporationSpatialDisplay</td>
            <td>min value for upper-left Surface Evaporation spatial panel.</td>
          </tr>
          <tr>
            <td>maxSurfaceEvaporationSpatialDisplay</td>
            <td>max value for upper-left Surface Evaporation spatial panel.</td>
          </tr>
          <tr>
            <td>minSurfaceLateralOutflowSpatialDisplay</td>
            <td>min value for upper-right Surface Lateral Outflow spatial panel.</td>
          </tr>
          <tr>
            <td>maxSurfaceLateralOutflowSpatialDisplay</td>
            <td>max value for upper-right Surface Lateral Outflow spatial panel.</td>
          </tr>
          <tr>
            <td>minSurfaceEvaporationDayDisplay</td>
            <td>min value for the left-side scale of the bottom Daily Averaged temporal panel.</td>
          </tr>
          <tr>
            <td>maxSurfaceEvaporationDayDisplay</td>
            <td>max value for the left-side scale of the bottom Daily Averaged temporal panel.</td>
          </tr>
          <tr>
            <td>maxRainDayDisplay</td>
            <td>max value for the right-side scale of the bottom Daily Averaged temporal panel.</td>
          </tr>
        </tbody>
      </table>
      <blockquote>
        <p>Note: there is no <code>minRainDayDisplay</code> parameter. Minimum rain is hardwired to &quot;0.0&quot;.</p>
      </blockquote>
      <p>Adjust these values to provide suitable color ramping for your simulation's range of evaporation and surface lateral outflow amount values.</p>

    </div>
  </div>
</body>
<footer id="footer">
  <p>VELMA 2.2 DOCUMENTATION</p>
</footer>
</head>

</html>