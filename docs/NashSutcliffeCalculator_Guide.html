<!DOCTYPE html>
<html>

<head>
  <meta name="viewport" content="width=device-width">
  <meta name="charset" content="utf-8">
  <link rel="stylesheet" type="text/css" href="/style.css">
  <title>DeveloperInfo</title>

<body class="bg-primary">
  <div class="header blue-base">
    <nav class="navbar blue-base navbar-expand"><a class="navbar-brand" href="/index.html">VELMA 2.2 HOME</a>
      <ul class="navbar-nav no-bullets">
        <li class="nav-item"><a class="nav-link" href="/intro.html"><span>I. Intro</span></a></li>
        <li class="nav-item"><a class="nav-link" href="/changes.html"><span>II. Changes from 1.0</span></a></li>
        <li class="nav-item"><a class="nav-link" href="/about.html"><span>III. About</span></a></li>
        <li class="nav-item"><a class="nav-link" href="/input_files.html"><span>IV. Input Files </span></a></li>
        <li class="nav-item"><a class="nav-link" href="/new_sim_config.html"><span>V. Sim Config</span></a></li>
        <li class="nav-item"><a class="nav-link" href="/parameter_config.html"><span>VI. Parameter Config</span></a></li>
        <li class="nav-item dropdown">Appendicies
          <ul class="nav-dropdown blue-light">
            <li class="nav-item"><a class="nav-link" href="/appendix_1.html"><span>Appendix 1</span></a></li>
            <li class="nav-item"><a class="nav-link" href="/appendix_2.html"><span>Appendix 2</span></a></li>
            <li class="nav-item"><a class="nav-link" href="/appendix_3.html"><span>Appendix 3</span></a></li>
            <li class="nav-item"><a class="nav-link" href="/appendix_4.html"><span>Appendix 4</span></a></li>
            <li class="nav-item"><a class="nav-link" href="/appendix_5.html"><span>Appendix 5</span></a></li>
            <li class="nav-item"><a class="nav-link" href="/appendix_6.html"><span>Appendix 6</span></a></li>
            <li class="nav-item"><a class="nav-link" href="/appendix_7.html"><span>Appendix 7</span></a></li>
          </ul>
        </li>
        <li class="nav-item dropdown">Supplemental
          <ul class="nav-dropdown blue-light">
            <li class="nav-item"><a class="nav-link" href="/supplement-a1.html"><span>Supplement A1</span></a></li>
            <li class="nav-item"><a class="nav-link" href="/supplement-a2.html"><span>Supplement A2</span></a></li>
            <li class="nav-item"><a class="nav-link" href="/supplement-a3.html"><span>Supplement A3</span></a></li>
            <li class="nav-item"><a class="nav-link" href="/supplement-a4.html"><span>Supplement A4</span></a></li>
            <li class="nav-item"><a class="nav-link" href="/supplement-b1.html"><span>Supplement B1</span></a></li>
            <li class="nav-item"><a class="nav-link" href="/supplement-b2.html"><span>Supplement B2</span></a></li>
            <li class="nav-item"><a class="nav-link" href="/supplement-b3.html"><span>Supplement B3</span></a></li>
            <li class="nav-item"><a class="nav-link" href="/supplement-b4.html"><span>Supplement B4</span></a></li>
            <li class="nav-item"><a class="nav-link" href="/supplement-b5.html"><span>Supplement B5</span></a></li>
            <li class="nav-item"><a class="nav-link" href="/supplement-b6.html"><span>Supplement B6</span></a></li>
            <li class="nav-item"><a class="nav-link" href="/supplement-b7.html"><span>Supplement B7</span></a></li>
            <li class="nav-item"><a class="nav-link" href="/supplement-b8.html"><span>Supplement B8</span></a></li>
            <li class="nav-item"><a class="nav-link" href="/supplement-b9.html"><span>Supplement B9</span></a></li>
            <li class="nav-item"><a class="nav-link" href="/supplement-b10.html"><span>Supplement B10</span></a></li>
            <li class="nav-item"><a class="nav-link" href="/supplement-c1.html"><span>Supplement C1</span></a></li>
            <li class="nav-item"><a class="nav-link" href="/supplement-c2.html"><span>Supplement C2</span></a></li>
            <li class="nav-item"><a class="nav-link" href="/supplement-c3.html"><span>Supplement C3</span></a></li>
            <li class="nav-item"><a class="nav-link" href="/supplement-d1.html"><span>Supplement D1</span></a></li>
            <li class="nav-item"><a class="nav-link" href="/supplement-d2.html"><span>Supplement D2</span></a></li>
            <li class="nav-item"><a class="nav-link" href="/supplement-d3.html"><span>Supplement D3</span></a></li>
            <li class="nav-item"><a class="nav-link" href="/supplement-d4.html"><span>Supplement D4</span></a></li>
            <li class="nav-item"><a class="nav-link" href="/supplement-d5.html"><span>Supplement D5</span></a></li>
            <li class="nav-item"><a class="nav-link" href="/supplement-d6.html"><span>Supplement D6</span></a></li>
            <li class="nav-item"><a class="nav-link" href="/supplement-d7a.html"><span>Supplement D7a</span></a></li>
                        <li class="nav-item"><a class="nav-link" href="/supplement-d7b.html"><span>Supplement D7b</span></a></li>
            <li class="nav-item"><a class="nav-link" href="/supplement-d8.html"><span>Supplement D8</span></a></li>
            <li class="nav-item"><a class="nav-link" href="/supplement-d9.html"><span>Supplement D9</span></a></li>
            <li class="nav-item"><a class="nav-link" href="/supplement-d10.html"><span>Supplement D10</span></a></li>
          </ul>
        </li>
        <li class="nav-item dropdown"> <a class="nav-link" href="/dev_info.html"><span>Developer Info</span></a>
          <ul class="nav-dropdown blue-light">
            <li class="nav-item"><a class="nav-link" href="/GetVelma_ForEclipse.html"><span>Clone Github to Local Machine</span></a></li>
            <li class="nav-item"><a class="nav-link" href="/CellSpecificBurnDisturbance_Configuration_Guide.html"><span>Cell Specific Burn Disturbance Config Guide</span></a></li>
            <li class="nav-item"><a class="nav-link" href="/Configuration_Checker_Guide.html"><span>Configuration Checker Guide</span></a></li>
            <li class="nav-item"><a class="nav-link" href="/DefaultSedimentModel_Configuration_Guide.html"><span>Default Sediment Model Config Guide</span></a></li>
            <li class="nav-item"><a class="nav-link" href="/ForestBurnLsrDisturbanceModel_Overview.html"><span>Forest Burn LSR Disturbance Model</span></a></li>
            <li class="nav-item"><a class="nav-link" href="/JPDEM_ReachMapping_Demonstration.html"><span>JPDEM Reaching Mapping Demo</span></a></li>
            <li class="nav-item"><a class="nav-link" href="/MinMaxAirT_WeatherDrivers.html"><span>Min Max Air Temp Weather Drivers</span></a></li>
            <li class="nav-item"><a class="nav-link" href="/ModifySpatialDataByMap_Guide.html"><span>Modify Spatial Data by Map Guide</span></a></li>
            <li class="nav-item"><a class="nav-link" href="/ObsRunoff_and_NaNs.html"><span>OBS Runnoff and NaNs</span></a></li>
            <li class="nav-item"><a class="nav-link" href="/OrganicContaminant_Overview.html"><span>Organic Contaminant Overview</span></a></li>
            <li class="nav-item"><a class="nav-link" href="/OrganicContaminant_Remediation_Configuration_Guide.html"><span>Organic Contaminant Redemption Config Guide</span></a></li>
            <li class="nav-item"><a class="nav-link" href="/OrganicContaminant_Tracer_Configuration_Guide.html"><span>Organic Contaminant Tracter Config Guide</span></a></li>
            <li class="nav-item"><a class="nav-link" href="/ReachSpecificObservedRunnoff.html"><span>Reach Specific Observed Runnoff</span></a></li>
            <li class="nav-item"><a class="nav-link" href="/Sediment_Output_Data_Summary.html"><span>Sediment Output Data Summary</span></a></li>
            <li class="nav-item"><a class="nav-link" href="/SnowDepth_Initialization_Guide.html"><span>Snow Depth Initialization Guide</span></a></li>
          </ul>
        </li>
        
        <li class="nav-item dropdown"> <a class="nav-link" href="/dev_utils.html"><span>Developer Utils</span></a>
          <ul class="nav-dropdown blue-light">
            <li class="nav-item"><a class="nav-link" href="/AscMapOct_Guide.html"><span>Ascii Map Oct Guide </span></a></li>
            <li class="nav-item"><a class="nav-link" href="/AscRangeMask_Guide.html"><span>Ascii Range Mask Guide</span></a></li>
            <li class="nav-item"><a class="nav-link" href="/MoeVelGenerator_Guide.html"><span>MOEA-to-VELMA Configuration Generator</span></a></li>
            <li class="nav-item"><a class="nav-link" href="/NashSutcliffeCalculator_Guide.html"><span>Tool for Computing Nash-Sutcliffe Coefficients</span></a></li>
            <li class="nav-item"><a class="nav-link" href="/NseQuarts_Guide.html"><span>NseQuarts Guide</span></a></li>
            <li class="nav-item"><a class="nav-link" href="/VelmaSimRunner_QuickRef.html"><span>VelmaSimRunner Quick Reference</span></a></li>
            <li class="nav-item"><a class="nav-link" href="/VelmaSimRunner.html"><span>VelmaSimRunner Full Guide</span></a></li>
          </ul>
        </li>
      </ul>
    </nav>
  </div>
  <div class="main_body">
    <div class="container">
      <h1>NashSutcliffeCalculator : A Tool for Computing Nash-Sutcliffe Coefficients</h1>
      <p>This guide explains how to use the NashSutcliffeCalculator utility.</p>
      <h2>Background</h2>
      <p>The VelmaSimulator engine automatically calculates a Nash-Sutcliffe coefficient for simulated-vs-observed watershed runoff values,
        but only if the following conditions are met:</p>
      <ol>
        <li>Observed runoff values are available for every day of driver data specified for the simulation run.</li>
        <li>Those observed runoff values are available in a properly-formatted .csv file, and that file is specified in the VELMA Simulation Configuration .xml file for the simulation run.</li>
      </ol>
      <p>Often, only partial or sparse observed runoff data is available for a given simulation site, or full runoff data only becomes available at some point after simulation runs have been completed.<br>
        In these cases, the NashSutcliffeCalculator utility can be used to compute a Nash-Sutcliffe value <em>after</em> the simulation run is completed, and can utilize partial or sparse observed data if that is all that is available.</p>
      <p>When NashSutcliffeCalculator is run from a command-line with the names of observed and simulation data files, it finds and pairs all the corresponding obs, sim data values, then computes the Nash-Sutcliffe coefficient for those data pairs.</p>
      <h2>Platform Requirements and Runtime Notes</h2>
      <p>Running NashSutcliffeCalculator as a command-line utility requires the following:</p>
      <ul>
        <li>Java 1.8 JRE (new versions should also work, but older versions -- e.g. 1.7 -- will not).</li>
        <li>Windows 10 (although the tool is not Windows-specific, Windows it the only platform it has been tested on).</li>
        <li>Windows Powershell (other shells should work, but PowerShell is the command shell it has been tested on).</li>
        <li>Access to either a JVelma .jar file (the NashSutcliffeCalculator is included in it)<br>
          or<br>
          Access to the <a href="https://github.com/USEPA/VELMA">VELMA source code</a> and a way to generate the .class files for at least the VelmaUtils/bin directory tree.
          (This is usually done by cloning a local copy of the VELMA project into an Eclipse workspace.)</li>
      </ul>
      <h2>Step-by-Step Instructions</h2>
      <h3>1. Determine Observed and Simulation Data File Sources</h3>
      <p>You must provide Nash-Sutcliffe with two comma-separated value (.csv) files:</p>
      <h3>An Observed Data File</h3>
      <ul>
        <li>Must contain 3 values per row, in this order: YEAR, JDAY, VALUE
          <ol>
            <li>YEAR must be a YYYY integer value.</li>
            <li>JDAY must be a JJJ (range [1, 366]) Julian day value.</li>
            <li>VALUE must be a floating-point data value.</li>
          </ol>
        </li>
        <li>Must <em>NOT</em> contain a header row.</li>
      </ul>
      <h3>A Simulation Data File</h3>
      <ul>
        <li>Must contain the following data, in the following (zero-based) column positions:
          <ol>
            <li>LOOP (an integer value) in column 0.</li>
            <li>YEAR (a YYYY integer value) in column 2.</li>
            <li>JDAY (a JJJ range [1, 366] value) in column 3.</li>
            <li>VALUE must be a floating-point data value in column 9.</li>
          </ol>
        </li>
      </ul>
      <p>The DailyResults.csv file generated as part of the standard results of a VELMA simulation run exactly meets the Simulation Data File requirements.</p>
      <h3>2. Run NashSutcliffeCalculator from a PowerShell Window</h3>
      <h3>Running from a <code>.jar</code> file</h3>
      <p>The command must include the location of the JVelma.jar file.<br>
        (The NashSutcliffeCalculator engine and <code>main()</code> method are included in JVelma.jar.)<br>
        A template for the command is:</p>
      <pre><code>java -cp C:\path\to\JVelma.jar gov.epa.velmautils.NashSutcliffeCalculator --obsFile=C:\full\path\to\obs.csv --simFile=C:\full\path\to\sim.csv
</code></pre>
      <h3>Running from a VELMA Eclipse Workspace</h3>
      <p>The command must include the location of VelmaUtils\bin within the Eclipes VELMA workspace.<br>
        A template for the command is:</p>
      <pre><code>java -cp C:\path\to\Velma\VelmaUtils\bin gov.epa.velmautils.NashSutcliffeCalculator --obsFile=C:\full\path\to\obs.csv --simFile=C:\full\path\to\sim.csv
</code></pre>
      <h2>Using NashSutcliffeCalculator within Java code</h2>
      <ol>
        <li>Create Java File objects for the observed and simulation data files.<br>
          (Also: perform any file-validation and &quot;bad file&quot; handling deemed necessary by your code.)</li>
      </ol>
      <pre><code>File obsFile = new File(&quot;C:/full/path/to/obs.csv&quot;);
File simFile = new File(&quot;C:/full/path/to/sim.csv&quot;);
</code></pre>
      <ol start="2">
        <li>Create a NashSutcliffeCalulator object, and pass the the obs and sim File objects to its constructor.</li>
      </ol>
      <pre><code>NashSutcliffeCalculator nsCalc = new NashSutcliffeCalculator(obsFile, simFile);
</code></pre>
      <ol start="3">
        <li>Set desired options by calling appropriate <code>set..()</code> methods on the NashSutcliffeCalculator object.<br>
          Options available when calling NashSutcliffeCalculator via a command line are also available via setter methods.<br>
          <strong>Important: Set options <em>before</em> calling <code>generateCoefficient()</code>!</strong><br>
          For example:
        </li>
      </ol>
      <pre><code>nsCalc.setSimMinYear(2010)
</code></pre>
      <p>is the source code equivalent to specifying</p>
      <pre><code>--setSimMinYear=2010 
</code></pre>
      <p>on the command line.
        4. Call the <code>generateCoefficient()</code> method to compute the coefficient value for the specified obs and sim data files, taking into account any</p>

    </div>
  </div>
</body>
<footer id="footer">
  <p>VELMA 2.2 DOCUMENTATION</p>
</footer>
</head>

</html>